{% extends "fuel/header.html" %}

{% block content %}
<script>
$(document).ready(function(){
    var fuel_data = {{fuel | safe}};
    var brand = ["7-Eleven", 
                "Better Choice", 
                "BOC", 
                "BP", 
                "Caltex", 
                "Caltex Woolworths",
                "Coles Express",
                "Eagle",
                "FastFuel 24/7",
                "Gull",
                "Independent",
                "Kleenheat",
                "Kwikfuel",
                "Liberty",
                "Mobil",
                "Peak",
                "Puma",
                "Shell",
                "United",
                "Vibe",
                "Wesco"];
    
    <!--Create unordered List -->
    var bList = $('ul.brand-list');
    $.each(brand, function(i){
        var li = $("<li/>")
            .attr("value", brand[i])
            .text(brand[i])
            .css("text-align", "center")
            .appendTo(bList);
    });
    
    $(".dropdown").on("hide.bs.dropdown", function(){
        $(".btn").html('Select Brand <span class="caret"></span>');
    });
    
    $("#filter-list li").on({
        mouseenter: function(){
            $(this).css("background-color", "gray")
        },
        mouseleave: function(){
            $(this).css("background-color", "white")
        },
        click: function(event){
            var value = $(this).text();
            $('table tr td:contains('+value+')').closest('tr').hide();
        }
    });
    
    $(".dropdown").on("show.bs.dropdown", function(){
        $(".btn").html('Select Brand <span class="caret caret-up"></span>');
    });
    
    <!--Populate and create Table -->
    $.makeTable = function (data) {
        var table = $('<table class="table table-striped">');
        <!-- table header -->
        var tblHeader = "<tr>";
        for (var k in data[0]) tblHeader += "<th style='text-align:center'>" + k.toUpperCase() + "</th>";
        tblHeader += "</tr>";
        $(tblHeader).appendTo(table);
        
        <!-- table row -->
        $.each(data, function (index, value) {
            var TableRow = "<tr>";
            $.each(value, function (key, val) {
                TableRow += "<td>" + val + "</td>";
            });
            TableRow += "</tr>";
            $(table).append(TableRow);
        });
        return ($(table));
    };
    
    var fuel_data = eval(fuel_data);
    var table = $.makeTable(fuel_data);
    $(table).appendTo("#fuelTable");
    
    <!-- Filter case-insensitive words -->
    $("#filter-input").on("keyup", function() {
        var value = $(this).val().toLowerCase();
        $("#fuelTable tr").filter(function() {
            $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
        });
    }); 
});
</script>

<div class= "jumbotron">
    <div class= "container-fluid">
        <h1>WA Fuel Scrapper using jQuery.js</h1>
    </div> 
</div>

<label class= "label label-default" for="filter">Filter By Word: </label>
<input id= "filter-input" class= "form-control" type= "text" placeholder="Search for ... "/>
<div class= "row">
    <div class = "col-md-2">
        <br>
        <div class= "dropdown">
            <label class= "label label-default" for="col-filter">Filter By Brand: </label>
            <button id= "button-list" class="btn btn-primary dropdown-toggle" type= "button" data-toggle= "dropdown">Select Brand <span class= "caret"></span></button>
            <ul id= "filter-list" class="brand-list dropdown-menu"></ul>
        </div>
    </div>
    <div class = "col-md-4">
        <br>
        <div class= "suburb">
            <label class= "label label-default" for="col-filter">Filter By Suburb: </label>
            <select id= "suburb-list" class="form-control">Select Suburb</button>
                {% if suburb %}
                    <option selected="selected">Any Suburb</option>
                    {% for v in suburb %}
                        <option value= {{ v }}> {{ v }} </option>
                    {% endfor %}
                {% endif %}
            </select>
        </div>
    </div>
    <div class = "col-md-2">
        <br>
        <div class= "date">
            <label class= "label label-default" for="col-filter">Filter By Date: </label>
            <select id= "date-list" class="form-control">Select Date</button>
                <option selected="selected" value= "today">Today</option>
                <option value= "tomorrow">Tomorrow</option>
                <option value= "yesterday">Yesterday</option>
            </select>
        </div>
    </div>
</div>
<hr>
<div id= "fuelTable" class= "container-fluid"></div>

{% endblock %}